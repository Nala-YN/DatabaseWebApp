{"ast":null,"code":"import { ElMessage } from 'element-plus';\nexport default {\n  name: \"userInfo\",\n  data() {\n    return {\n      userinfo: {\n        username: \"faqfaq\",\n        phonenum: \"13586012465\",\n        email: \"2654133250@qq.com\",\n        campus: \"学院路校区\",\n        address: \"大运村\",\n        money: 114.54545\n      },\n      image_src: \"https://img.puchedu.cn/uploads/2/253/2649383158/203006361.jpg\",\n      modifyphonenum: false,\n      modifypassword: false,\n      modifyemail: false,\n      modifycampus: false,\n      modifyaddress: false,\n      modifymoney: false,\n      input: \"\",\n      confirm: \"\",\n      oldPassword: \"\"\n    };\n  },\n  methods: {\n    toFixed2(str) {\n      let num = Number(str);\n      return isNaN(num) ? str : num.toFixed(2);\n    },\n    modify(which) {\n      if (which === \"password\") {\n        if (this.input != this.confirm) {\n          ElMessage({\n            message: \"确认密码与新密码不一致\",\n            type: \"error\"\n          });\n          return;\n        }\n        this.$http.post(\"/api/modifypassword\", {\n          user_id: this.$store.getters.status.userid,\n          old_pw: this.oldPassword,\n          new_pw: this.input\n        }).then(response => {\n          if (response.data.success === true) {\n            ElMessage({\n              message: \"修改成功\",\n              type: \"success\"\n            });\n          } else {\n            ElMessage({\n              message: \"修改失败，请确认旧密码是否正确\",\n              type: \"error\"\n            });\n          }\n        }).catch(error => {\n          ElMessage({\n            message: error,\n            type: \"error\"\n          });\n          return;\n        });\n      } else {\n        if (which === \"phonenum\") {\n          this.userinfo.phonenum = this.input;\n          this.modifyphonenum = false;\n        } else if (which === \"email\") {\n          this.userinfo.email = this.input;\n          this.modifyemail = false;\n        } else if (which === \"campus\") {\n          this.userinfo.campus = this.input;\n          this.modifycampus = false;\n        } else if (which === \"address\") {\n          this.userinfo.address = this.input;\n          this.modifyaddress = false;\n        } else if (which === \"money\") {\n          var num = parseFloat(this.input);\n          if (isNaN(num)) {\n            ElMessage({\n              message: \"请输入正确的数额\",\n              type: \"error\"\n            });\n          } else {\n            this.userinfo.money = parseFloat(this.userinfo.money) + num;\n            this.modifymoney = false;\n            this.input = this.userinfo.money;\n          }\n        }\n        this.$http.post(\"/api/modifyinfo\", {\n          user_id: this.$store.getters.status.userid,\n          modify_which: which,\n          modify_content: this.input\n        }).then().catch(error => {\n          ElMessage({\n            message: error,\n            type: \"error\"\n          });\n          return;\n        });\n        if (which === \"money\") {\n          ElMessage({\n            message: \"充值成功\",\n            type: \"success\"\n          });\n        } else {\n          ElMessage({\n            message: \"修改成功\",\n            type: \"success\"\n          });\n        }\n      }\n      this.input = \"\";\n      this.confirm = \"\";\n      this.oldPassword = \"\";\n    }\n  },\n  mounted() {\n    this.$http.post('/api/getuserinfo', {\n      user_id: this.$store.getters.status.userid\n    }).then(response => {\n      this.userinfo = response.data.userinfo;\n    }).catch(error => {\n      ElMessage({\n        message: error,\n        type: \"error\"\n      });\n    });\n  }\n};","map":{"version":3,"names":["ElMessage","name","data","userinfo","username","phonenum","email","campus","address","money","image_src","modifyphonenum","modifypassword","modifyemail","modifycampus","modifyaddress","modifymoney","input","confirm","oldPassword","methods","toFixed2","str","num","Number","isNaN","toFixed","modify","which","message","type","$http","post","user_id","$store","getters","status","userid","old_pw","new_pw","then","response","success","catch","error","parseFloat","modify_which","modify_content","mounted"],"sources":["C:\\Users\\faq\\Desktop\\DatabaseWebApp\\client\\src\\components\\Userinfo.vue"],"sourcesContent":["<template>\r\n    <div style=\"display: flex; justify-content: center; padding-top: 10vh; height: 100vh;\">\r\n        <el-card style=\"width: 70vw;height: 41vw;\">\r\n            <el-container>\r\n                <el-container> <el-aside width=\"500px\" style=\"display: flex;justify-content:center;align-items: center;\">\r\n                    <el-avatar shape=\"square\" :size=\"300\" :src='image_src' /></el-aside>\r\n                    <el-main> <el-descriptions direction=\"vertical\" :column=\"1\" :size=\"size\" border>\r\n                            <el-descriptions-item label=\"账号\">{{ userinfo.username }}</el-descriptions-item>\r\n                            <el-descriptions-item label=\"电话号码\">{{ userinfo.phonenum }}</el-descriptions-item>\r\n                            <el-descriptions-item label=\"邮箱\" :span=\"2\">{{ userinfo.email }}</el-descriptions-item>\r\n                            <el-descriptions-item label=\"所在校区\">{{ userinfo.campus }}</el-descriptions-item>\r\n                            <el-descriptions-item label=\"详细地址\">{{ userinfo.address }}</el-descriptions-item>\r\n                            <el-descriptions-item label=\"账户余额\">{{ toFixed2(userinfo.money) }}</el-descriptions-item>\r\n                        </el-descriptions></el-main></el-container>\r\n                <el-footer>\r\n                    <div style=\"padding-top: 30px;\">\r\n                        <el-button type=\"primary\" class=“button” size=“large” style=\"align-items:end\"\r\n                            @click=\"modifyphonenum = true\">修改电话号码</el-button>\r\n                        <el-button type=\"primary\" class=“button” size=“large” style=\"align-items:end\"\r\n                            @click=\"modifyemail = true\">修改邮箱</el-button>\r\n                        <el-button type=\"primary\" class=“button” size=“large” style=\"align-items:end\"\r\n                            @click=\"modifycampus = true\">修改所在校区</el-button>\r\n                        <el-button type=\"primary\" class=“button” size=“large” style=\"align-items:end\"\r\n                            @click=\"modifyaddress = true\">修改详细地址</el-button>\r\n                        <el-button type=\"primary\" class=“button” size=“large” style=\"align-items:end\"\r\n                            @click=\"modifypassword = true\">修改密码</el-button>\r\n                        <el-button type=\"primary\" class=“button” size=“large” style=\"align-items:end\"\r\n                            @click=\"modifymoney = true\">充值账户余额</el-button>\r\n                    </div>\r\n                </el-footer>\r\n            </el-container>\r\n        </el-card>\r\n    </div>\r\n    <el-dialog v-model=\"modifyphonenum\" title=\"修改电话号码\" width=\"30%\">\r\n        <el-input v-model=\"input\" placeholder=\"请输入新的电话号码\" />\r\n        <div style=\"display:flex;justify-content: end;padding-top: 10px;\">\r\n            <el-button type=\"primary\" class=“button” size=“large” @click=\"modify('phonenum')\">确认修改</el-button>\r\n        </div>\r\n    </el-dialog>\r\n    <el-dialog v-model=\"modifyemail\" title=\"修改邮箱\" width=\"30%\">\r\n        <el-input v-model=\"input\" placeholder=\"请输入新的邮箱\" />\r\n        <div style=\"display:flex;justify-content: end;padding-top: 10px;\">\r\n            <el-button type=\"primary\" class=“button” size=“large” @click=\"modify('email')\">确认修改</el-button>\r\n        </div>\r\n    </el-dialog>\r\n    <el-dialog v-model=\"modifymoney\" title=\"充值账户余额\" width=\"30%\">\r\n        <el-input v-model=\"input\" placeholder=\"请输入要充值的数额\" />\r\n        <div style=\"display:flex;justify-content: end;padding-top: 10px;\">\r\n            <el-button type=\"primary\" class=“button” size=“large” @click=\"modify('money')\">确认充值</el-button>\r\n        </div>\r\n    </el-dialog>\r\n    <el-dialog v-model=\"modifycampus\" title=\"修改所在校区\" width=\"30%\">\r\n        <el-input v-model=\"input\" placeholder=\"请输入所在校区\" />\r\n        <div style=\"display:flex;justify-content: end;padding-top: 10px;\">\r\n            <el-button type=\"primary\" class=“button” size=“large” @click=\"modify('campus')\">确认修改</el-button>\r\n        </div>\r\n    </el-dialog>\r\n    <el-dialog v-model=\"modifyaddress\" title=\"修改详细地址\" width=\"30%\">\r\n        <el-input v-model=\"input\" placeholder=\"请输入新的地址\" />\r\n        <div style=\"display:flex;justify-content: end;padding-top: 10px;\">\r\n            <el-button type=\"primary\" class=“button” size=“large” @click=\"modify('address')\">确认修改</el-button>\r\n        </div>\r\n    </el-dialog>\r\n    <el-dialog v-model=\"modifypassword\" title=\"修改密码\" width=\"30%\">\r\n        <el-input v-model=\"oldPassword\" type=\"password\" placeholder=\"请输入旧密码\" />\r\n        <el-input v-model=\"input\" type=\"password\" placeholder=\"请输入新的密码\" style=\"padding-top: 10px;\" />\r\n        <el-input v-model=\"confirm\" type=\"password\" placeholder=\"确认新的密码\" style=\"padding-top: 10px;\" />\r\n        <div style=\"display:flex;justify-content: end;padding-top: 10px;\">\r\n            <el-button type=\"primary\" class=“button” size=“large” @click=\"modify('password')\">确认修改</el-button>\r\n        </div>\r\n    </el-dialog>\r\n</template>\r\n<script>\r\nimport { ElMessage } from 'element-plus';\r\nexport default {\r\n    name: \"userInfo\",\r\n    data() {\r\n        return {\r\n            userinfo: {\r\n                username: \"faqfaq\",\r\n                phonenum: \"13586012465\",\r\n                email: \"2654133250@qq.com\",\r\n                campus: \"学院路校区\",\r\n                address: \"大运村\",\r\n                money: 114.54545\r\n            },\r\n            image_src:\"https://img.puchedu.cn/uploads/2/253/2649383158/203006361.jpg\",\r\n            modifyphonenum: false,\r\n            modifypassword: false,\r\n            modifyemail: false,\r\n            modifycampus: false,\r\n            modifyaddress: false,\r\n            modifymoney: false,\r\n            input: \"\",\r\n            confirm: \"\",\r\n            oldPassword: \"\"\r\n        }\r\n    },\r\n    methods: {\r\n        toFixed2(str) {\r\n            let num = Number(str);\r\n            return isNaN(num) ? str : num.toFixed(2);\r\n        },\r\n        modify(which) {\r\n            if (which === \"password\") {\r\n                if (this.input != this.confirm) {\r\n                    ElMessage({ message: \"确认密码与新密码不一致\", type: \"error\" });\r\n                    return;\r\n                }\r\n                this.$http.post(\"/api/modifypassword\", {\r\n                    user_id: this.$store.getters.status.userid,\r\n                    old_pw: this.oldPassword,\r\n                    new_pw: this.input\r\n                }).then(response => {\r\n                    if (response.data.success === true) {\r\n                        ElMessage({ message: \"修改成功\", type: \"success\" })\r\n                    }\r\n                    else {\r\n                        ElMessage({ message: \"修改失败，请确认旧密码是否正确\", type: \"error\" })\r\n                    }\r\n                }).catch(error => {\r\n                    ElMessage({ message: error, type: \"error\" })\r\n                    return;\r\n                });\r\n            }\r\n            else {\r\n                if (which === \"phonenum\") {\r\n                    this.userinfo.phonenum = this.input;\r\n                    this.modifyphonenum = false;\r\n                }\r\n                else if (which === \"email\") {\r\n                    this.userinfo.email = this.input;\r\n                    this.modifyemail = false;\r\n                }\r\n                else if (which === \"campus\") {\r\n                    this.userinfo.campus = this.input;\r\n                    this.modifycampus = false;\r\n                }\r\n                else if (which === \"address\") {\r\n                    this.userinfo.address = this.input;\r\n                    this.modifyaddress = false;\r\n                }\r\n                else if (which === \"money\") {\r\n                    var num = parseFloat(this.input)\r\n                    if (isNaN(num)) {\r\n                        ElMessage({ message: \"请输入正确的数额\", type: \"error\" })\r\n                    }\r\n                    else {\r\n                        this.userinfo.money = parseFloat(this.userinfo.money) + num;\r\n                        this.modifymoney = false;\r\n                        this.input = this.userinfo.money\r\n                    }\r\n                }\r\n                this.$http.post(\"/api/modifyinfo\", {\r\n                    user_id: this.$store.getters.status.userid,\r\n                    modify_which: which,\r\n                    modify_content: this.input\r\n                }).then().catch(error => {\r\n                    ElMessage({ message: error, type: \"error\" })\r\n                    return;\r\n                });\r\n                if (which === \"money\") {\r\n                    ElMessage({ message: \"充值成功\", type: \"success\" })\r\n                }\r\n                else {\r\n                    ElMessage({ message: \"修改成功\", type: \"success\" })\r\n                }\r\n\r\n            }\r\n            this.input = \"\";\r\n            this.confirm = \"\";\r\n            this.oldPassword = \"\";\r\n        }\r\n    },\r\n    mounted() {\r\n        this.$http.post('/api/getuserinfo', {\r\n            user_id: this.$store.getters.status.userid,\r\n        }).then(response => {\r\n            this.userinfo = response.data.userinfo\r\n        }).catch(error => {\r\n            ElMessage({ message: error, type: \"error\" })\r\n        })\r\n    }\r\n}\r\n</script>\r\n<style></style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}